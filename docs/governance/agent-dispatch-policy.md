# 真实 Agent 派工与验真制度（V2.0）

**发布人**：副总经理（慢羊羊）  
**适用对象**：蛋蛋（派工人）及全体团队 Agent  
**生效时间**：2026-02-28  
**版本说明**：在原试行版基础上，吸收“变形金刚团队”实战验真方法，新增“4类硬证据验真 + 固定验收模板 + 隔离证据机制”。  
**总原则**：**一切任务必须真账号、真调用、真留痕、真隔离。**

---

## 0. 制度目标

1. 防止“通用子agent扮演指定角色”的冒充执行。
2. 确保每个任务可追溯到唯一真实 Agent 会话。
3. 用可复核的硬证据证明“确实在该 agent 的真实工作区执行过真实动作”。
4. 在保证效率的同时，守住质量与治理底线。

---

## 1. 派工强制规则（防冒充）

1. 派工时必须指定真实 `agentId`（如 `meiyangyang`、`xiaohuihui`、`feiyangyang`）。
2. 禁止使用“通用子agent + prompt扮演角色”替代真实 agent。
3. 派工单必须包含以下字段，缺一不可：
   - `taskId`
   - `agentId`（唯一真实 ID）
   - `dispatcher`（派工人）
   - `deadline`
   - `acceptance_criteria`（验收标准）
4. 系统/流程闸门：若未填写 `agentId` 或 `agentId=generic/common`，任务**不得创建**。
5. 派工人必须在派工消息中明确要求“回传固定验收模板”（见第4章），否则视为派工不完整。

---

## 2. 执行验真机制（升级为4类硬证据）

每个任务完成时，必须同时提交以下 **4类硬证据**。任一类缺失，任务不得标记完成。

### 2.1 身份证据（Identity Evidence）

必须回传：
1. runtime 关键信息中的 `agent=...` 与 `session id`。
2. 读取并复述本 agent 的 `SOUL.md` 首段（用于证明“我是我”，非口头自称）。

判定要点：
- `agent` 必须与派工单 `agentId` 一致。
- `session id` 必须可在执行日志中追溯。

### 2.2 工作区证据（Workspace Evidence）

必须回传原始命令输出：
1. `pwd`（展示当前工作目录）
2. `ls`（展示当前 agent 专属目录文件）

判定要点：
- 路径应落在该 agent 预期工作区内。
- 文件结构应与该 agent 实际目录特征一致。

### 2.3 隔离证据（Isolation Evidence）

必须执行一次跨 agent 可见性测试，并回传原始输出：
1. 尝试读取另一个 agent 的私有文件（如 `SOUL.md`、私有记忆、专属配置）。
2. 预期结果应为“不可见/不存在/无权限”。
3. 必须附文字声明：**可见边界**（能看到什么、不能看到什么）。

判定要点：
- 若可直接读取他人私有文件，视为隔离失效，任务挂起并触发安全审计。
- 若因平台共享目录导致部分可见，必须如实上报边界，不得隐瞒。

### 2.4 执行证据（Execution Evidence）

必须执行一个真实外部动作并回传原始输出（非伪造文本、非“已执行”口头描述），例如：
- 真实 shell 命令执行输出
- 真实工具调用返回
- 真实网络查询/系统状态输出

判定要点：
- 输出必须含时间性/环境性特征，能证明是现场执行。
- 禁止粘贴模板化假输出。

---

## 3. 证据链判定标准（由“三段”升级为“四证合一”）

任务完成必须满足以下一致性：

1. **派工证据**：派工记录存在明确 `taskId + agentId`。  
2. **身份证据**：`runtime.agent` 与派工 `agentId` 一致，且有 `session id`。  
3. **工作区证据**：`pwd/ls` 证明在目标 agent 工作区执行。  
4. **隔离证据**：跨agent私有文件访问测试结果清晰，边界声明完整。  
5. **执行证据**：真实外部动作原始输出可复核。  
6. **交付证据**：产出记录包含 `taskId + agentId + completion timestamp`。

> 验真结论：以上 6 项全部满足，方可判定“真实执行完成”；否则为“未通过验真”。

---

## 4. 固定验收模板（所有子agent统一）

> 以下模板为强制格式，派工时必须附带，子agent回传时不得删减字段。

```markdown
# Agent任务验收回执（强制模板）
- Agent ID: <agentId>
- Session ID: <session_id>
- Model: <model_name>
- Workspace (pwd): <pwd原始输出>
- SOUL.md 摘要: <SOUL.md首段复述>
- 跨agent文件可见性测试结果: <测试命令 + 原始输出 + 可见边界说明>
- 外部命令执行结果（原始输出）: <命令/工具 + 原始输出>
- 交付物清单: <文件路径/链接/变更说明>
- Completion Timestamp: <YYYY-MM-DD HH:mm:ss TZ>
```

模板使用规则：
1. 字段齐全才可进入验收。
2. “原始输出”不得二次加工成结论性摘要替代。
3. 若输出过长，允许“摘要 + 附件/日志链接”，但必须保留可审计原文。

---

## 5. 隔离证据机制（新增）

### 5.1 测试要求

- 每个任务至少执行 1 次跨agent私有文件读取测试。
- 测试对象应是“非本agent私有路径/文件”，优先选择：
  - 另一个 agent 的 `SOUL.md`
  - 另一个 agent 的 `memory/` 私有日志
  - 另一个 agent 的专属配置文件

### 5.2 结果分级

- **P0（通过）**：不可见/不存在/无权限，且边界声明清楚。
- **P1（有条件通过）**：可见共享目录，但私有文件仍不可读；需补充边界说明。
- **F（失败）**：可读取他人私有文件或边界声明缺失。

### 5.3 失败处置

- 立即暂停该任务验收。
- 由副总发起隔离风险审计。
- 必要时升级至大人裁决，并在周报中单列“隔离失效”事件。

---

## 6. 违规分级与问责（保留并强化）

- A类：未填写真实 `agentId` 派工。
- B类：使用通用子agent冒充指定角色执行。
- C类：篡改或缺失关键验真记录。
- D类（新增）：未按固定模板回传，或故意规避隔离证据测试。
- E类（新增重大）：伪造“外部执行输出”或隐瞒跨agent可见性事实。

处置：
- **首次违规**：任务打回 + 书面复盘 + 当日重派真实 agent。
- **两次违规（30天内）**：暂停派工权限 1 个工作日，副总复核后恢复。
- **三次及以上（30天内）**：升级至大人裁决。
- **故意规避/伪造证据（含E类）**：重大流程违规，直接上报大人并进入专项审计。

---

## 7. 副总监督机制（慢羊羊负责，保留）

1. **日抽检**：每日抽检不少于 30% 任务，核对“4类硬证据 + 固定模板”。
2. **周审计**：每周输出《Agent 派工合规简报》，新增隔离测试通过率指标。
3. **一票打回权**：发现冒充执行、模板缺失、隔离证据不实，副总直接判定无效并重派。
4. **流程优化权**：根据审计结果持续更新闸门规则与模板字段。

---

## 8. 派工人（蛋蛋）执行清单

派工前：
- [ ] 已填写真实 `agentId`
- [ ] 已附固定验收模板
- [ ] 已写明本任务外部执行动作要求

验收时：
- [ ] 收到 `Agent ID / Session ID / Model`
- [ ] 收到 `pwd + ls` 原始输出
- [ ] 收到跨agent可见性测试原始输出与边界声明
- [ ] 收到真实外部动作原始输出
- [ ] 交付记录含 `taskId + agentId + timestamp`

任一项未满足：
- [ ] 打回，不得“口头放行”

---

## 9. 落地口令（更新）

> **“无 agentId 不派工；无四类硬证据不验收；无固定模板不通过；有冒充或伪造一律打回并追责。”**

---

## Agent ID 对照表

| agentId | 角色 | 职责 |
|---------|------|------|
| meiyangyang | 美羊羊🎀 | CTO，前端、后端、平台 |
| xiaohuihui | 小灰灰🐺 | 固件、3D建模、硬件 |
| feiyangyang | 沸羊羊🐏 | 后端开发、API、数据库 |
| huayangyang | 花羊羊🌸 | 工业设计、UX、品牌 |
| xiyangyang | 喜羊羊☀️ | 运营、i18n、社区 |
| nuanyangyang | 暖羊羊🐑 | 测试、审计 |
| manyangyang | 慢羊羊🧓 | 副总，战略审查、质量把关 |
| daoyang | 刀羊🗡️ | 采购、物流、成本 |
| arch | 灰太狼🐺 | 架构 |
| pmo | 智羊羊🎓 | PMO |
| sre-release | 红太狼🚦 | SRE/发布 |
