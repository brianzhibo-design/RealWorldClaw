# RealWorldClaw 核心主机 - 硬件架构与外壳设计 v2

> 作者：小灰灰🐺（硬件工程师）
> 日期：2026-02-21
> 状态：设计草案

---

## 1. 硬件架构

### 1.1 核心板选型

**ESP32-S3-Touch-LCD-1.46B**（Waveshare/斑梨）

| 参数 | 规格 |
|------|------|
| MCU | ESP32-S3R8, 双核LX7, 240MHz |
| 内存 | 512KB SRAM + 8MB PSRAM |
| Flash | 16MB |
| 显示 | 1.46" 圆形IPS, 412×412, QSPI (SPD2010) |
| 触摸 | 电容触摸 (SPD2010, I2C) |
| IMU | QMI8658 六轴（加速度+陀螺仪）|
| RTC | PCF85063, 独立纽扣电池供电 |
| 音频输出 | PCM5101 DAC + 板载扬声器 |
| 麦克风 | I2S MEMS MIC |
| 存储扩展 | TF卡槽 |
| 电池 | MX1.25接口, 3.7V锂电, 板载充放电管理 |
| 无线 | WiFi 802.11 b/g/n + BLE 5.0 |
| PCB形状 | 圆形, 直径约43.5mm |
| 接口 | USB-C, I2C排针, UART排针 |

### 1.2 系统框图

```
                        ┌─────────────────────────────┐
                        │       ESP32-S3R8             │
                        │   (240MHz dual-core LX7)     │
                        │   512KB SRAM + 8MB PSRAM     │
                        │   16MB Flash                 │
                        └──────────┬──────────────────-┘
                                   │
        ┌──────────┬───────────┬───┴───┬──────────┬──────────┐
        │          │           │       │          │          │
   ┌────┴───┐ ┌───┴────┐ ┌───┴──┐ ┌──┴───┐ ┌───┴───┐ ┌───┴────┐
   │ QSPI   │ │  I2C   │ │ I2S  │ │ I2S  │ │  SPI  │ │  UART  │
   │ Display │ │  Bus   │ │ OUT  │ │ IN   │ │       │ │        │
   │SPD2010 │ │(GPIO10 │ │PCM   │ │ MIC  │ │TF Card│ │ USB-C  │
   │412×412 │ │ GPIO11)│ │5101  │ │      │ │       │ │GPIO43/44│
   │+Touch  │ │        │ │+SPK  │ │      │ │       │ │        │
   └────────┘ ├────────┤ └──────┘ └──────┘ └───────┘ └────────┘
              │QMI8658 │
              │PCF85063│
              │RWC Bus │◄── 外部扩展模块
              └────────┘
```

**关键GPIO分配（板载已用）：**

| 功能 | GPIO |
|------|------|
| LCD QSPI数据 | 46, 45, 42, 41 |
| LCD CLK/CS | 40, 21 |
| LCD背光 | 5 |
| LCD TE | 18 |
| 触摸/I2C (SCL/SDA) | 10, 11 |
| 触摸中断 | 4 |
| IMU/RTC | 共享I2C (10, 11) |
| RTC中断 | 9 |
| MIC (I2S) | WS=2, SCK=15, SD=39 |
| Speaker (I2S) | DIN=47, LRCK=38, BCK=48 |
| TF卡 (SPI) | MISO=16, MOSI=17, SCK=14 |
| UART | TX=43, RX=44 |
| USB | DN=19, DP=20 |
| GPIO扩展 (TCA9554) | 通过I2C控制EXIO1-5 |

### 1.3 RWC Bus 定义

**8-Pin 2.54mm排针/排母接口**

| Pin | 信号 | 说明 |
|-----|------|------|
| 1 | 5V | USB供电直通，模块可取电（最大500mA共享） |
| 2 | 3V3 | 3.3V稳压输出（最大200mA给模块） |
| 3 | GND | 公共地 |
| 4 | SDA | I2C数据线 (GPIO11)，3.3V电平 |
| 5 | SCL | I2C时钟线 (GPIO10)，400kHz |
| 6 | TX/MOSI | UART TX (GPIO43) 或 SPI MOSI（固件配置） |
| 7 | RX/MISO | UART RX (GPIO44) 或 SPI MISO（固件配置） |
| 8 | ID | 模块识别（ADC输入，建议GPIO1或GPIO3） |

### 1.4 模块扩展策略

**I2C扩展（主要方式）：**
- I2C总线理论最多127个地址，实际受限于总线电容
- 板载已占用地址：SPD2010(触摸), QMI8658(0x6B), PCF85063(0x51), TCA9554(0x20)
- **建议每个扩展模块使用独立I2C地址，预留地址范围0x30-0x4F给模块**
- 总线加上拉电阻（板载已有），线长不超过30cm

**ID Pin识别：**
- 每个模块内置不同阻值电阻分压，主机ADC读取识别模块类型
- 建议方案：
  - 无模块：ID悬空（内部上拉→3.3V）
  - 模块A（如servo）：10K分压→约2.5V
  - 模块B（如LED）：22K分压→约1.5V
  - 模块C（如sensor）：47K分压→约0.8V
  - 可区分约8-10种模块（ADC 12bit精度足够）

**最大同时连接数：**
- 单RWC Bus口：**1个模块**（物理限制）
- 如需多模块：通过**RWC Hub扩展坞**（未来产品），星形拓扑
- Hub方案：I2C总线直通 + 每路独立ID pin + 独立供电管理
- 建议Hub最多**4路**（I2C总线电容限制 + 供电限制）

**UART/SPI模式（Pin6/7）：**
- 默认UART模式，适合简单通信模块
- 固件可切换为SPI模式，适合高速数据模块（如摄像头）
- 同一时间只能选一种模式

---

## 2. 外壳设计方案

### 通用约束

- 核心板PCB：圆形，直径≈43.5mm，厚度≈8mm（含元件）
- 屏幕区域：圆形，有效显示直径≈37mm（1.46"）
- 电池：3.7V锂电，建议402530（25×30×4mm, ~250mAh）或503030（30×30×5mm, ~500mAh）
- USB-C口需从外壳露出
- 扬声器需声腔（外壳留出音腔空间）
- 麦克风需拾音孔
- P2S打印尺寸限制：256×256×256mm（远大于我们需求）

---

### 方向A：圆润有机体 —— "Pebble"（鹅卵石）

**概念：** 一颗被河水打磨的智慧石头。拿在手里温暖圆润，放在桌上安静存在。屏幕像一只眼睛从石头里透出来。

**外形描述：**
- 整体形状：扁椭球体，俯视近圆形
- 尺寸：65mm(宽) × 65mm(深) × 30mm(高)
- 正面：圆形屏幕窗口（凹入1mm形成"眼窝"）
- 底面：略平，自然站立；中心RWC Bus 8pin母座
- 侧面：USB-C开口、麦克风小孔、扬声器格栅（底部弧面上的细槽阵列）
- 质感：建议PLA丝绸色（silk），或砂石纹理PLA

**零件清单（2件）：**

| # | 零件 | 说明 |
|---|------|------|
| 1 | 上壳 (Top Shell) | 含屏幕窗口、扬声器格栅、麦克风孔 |
| 2 | 底盖 (Bottom Cap) | 含RWC Bus开口、USB-C开口、电池仓 |

**组装方式：** 卡扣式。底盖边缘4个弹性卡扣，扣入上壳内壁凹槽。可徒手开合。

**RWC Bus位置：** 底面中心，朝下。模块从下方插入。放桌上时模块藏在底部，整洁。

**打印参数：**
- 层高：0.16mm（外观件，细腻）
- 填充：15% gyroid
- 壁厚：1.6mm（4圈）
- 支撑：上壳内部需支撑（屏幕窗口悬垂），底盖无需
- 悬垂：最大约45°，P2S可处理
- 打印方向：上壳开口朝上打印；底盖平放

**OpenSCAD伪代码：**
```openscad
// Pebble - 核心参数
pcb_d = 44;          // PCB直径
screen_d = 39;       // 屏幕可视直径
shell_d = 65;        // 外壳直径
shell_h = 30;        // 总高度
wall = 1.6;          // 壁厚
split_z = 20;        // 上下壳分割高度

// 上壳
module top_shell() {
  difference() {
    // 扁椭球体
    scale([1, 1, shell_h/shell_d])
      sphere(d=shell_d, $fn=120);
    
    // 掏空内部
    scale([1, 1, (shell_h-wall*2)/shell_d])
      sphere(d=shell_d-wall*2, $fn=120);
    
    // 切掉下半部分
    translate([0,0,-shell_h])
      cube(shell_d*2, center=true);
    
    // 屏幕窗口（圆形通孔）
    translate([0, 0, shell_h/2-2])
      cylinder(d=screen_d+1, h=10, $fn=80);
    
    // USB-C槽口 (侧面)
    translate([shell_d/2-5, 0, split_z/2])
      cube([12, 9, 3.5], center=true);
    
    // 扬声器格栅（底部侧面一排细槽）
    for(i=[-3:3])
      translate([0, i*2.5, 3])
        rotate([0, 90, 30])
          cylinder(d=1, h=shell_d, $fn=20);
    
    // 麦克风孔
    translate([-shell_d/2+3, 0, split_z/2+3])
      cylinder(d=1.5, h=5, $fn=20);
  }
  // 内部卡扣凹槽（4处）
}

// 底盖
module bottom_cap() {
  difference() {
    // 扁圆盘
    cylinder(d=shell_d-0.3, h=split_z-wall, $fn=120);  // 略小于上壳内径
    
    // 掏空
    translate([0, 0, wall])
      cylinder(d=shell_d-wall*2-0.3, h=split_z, $fn=120);
    
    // RWC Bus 8pin开口（底面中心）
    translate([0, 0, -1])
      cube([22, 3, wall+2], center=true);  // 2.54mm×8pin
  }
  // 4个弹性卡扣
  // PCB支撑柱（3个，120°均布）
  for(a=[0,120,240])
    rotate([0,0,a])
      translate([pcb_d/2-3, 0, wall])
        cylinder(d=3, h=4, $fn=20);
}
```

**P2S兼容性：** ✅ 完全没问题。最大尺寸65mm，远小于打印范围。椭球体悬垂平滑，P2S的自适应层高可很好处理。

---

### 方向B：几何极简 —— "Crystal"（晶体）

**概念：** 像一颗切割过的宝石或矿物晶体。平面与平面相交的棱线清晰但微圆角（R1mm），科技感强。可更换彩色面板让同一个核心有不同"皮肤"。

**外形描述：**
- 整体形状：截角正八面体（类似切割钻石的亭部+冠部简化版），或更简单的**倒角立方体**
- 推荐：**软倒角正六边形柱体**（hexagonal prism with chamfered edges）
- 尺寸：对边距62mm × 高28mm
- 正面（顶面）：六边形面上圆形屏幕窗口
- 底面：六边形，平放稳定
- 侧面六面：其中一面有USB-C开口，对面有RWC Bus开口
- 质感：建议亮面PLA或金属色PLA（金、银、铜）

**零件清单（3-5件，模块化）：**

| # | 零件 | 说明 |
|---|------|------|
| 1 | 内框 (Core Frame) | 结构骨架，固定PCB和电池，不可见 |
| 2 | 顶面板 (Top Plate) | 含屏幕窗口，磁吸固定，可换色 |
| 3 | 底面板 (Bottom Plate) | 磁吸固定，可换色 |
| 4 | 侧裙 (Side Skirt) | 六边形环，包裹侧面，含USB-C/RWC Bus开口 |

**组装方式：** 内框承载一切；面板通过6mm×2mm圆形磁铁吸附（每面3颗，内框对应位置嵌磁铁）。侧裙卡扣到内框。

**RWC Bus位置：** 侧面（六边形的一条边），与USB-C对面。模块水平插入。

**打印参数：**
- 层高：0.12mm（棱线清晰度很重要）
- 填充：20% grid
- 壁厚：1.2mm（3圈）
- 支撑：内框可能需少量支撑（PCB卡槽悬垂）；面板无需
- 每个面板可用不同颜色/材料打印
- 打印方向：面板平放；侧裙立起来打印（减少支撑）

**OpenSCAD伪代码：**
```openscad
// Crystal - 核心参数
hex_r = 35;          // 六边形外接圆半径（对边距≈60.6mm）
body_h = 28;         // 总高度
chamfer = 4;         // 倒角宽度
screen_d = 39;       // 屏幕可视直径
wall = 1.2;
magnet_d = 6;        // 磁铁直径
magnet_h = 2;        // 磁铁厚度

// 倒角六边形柱体
module chamfered_hex(r, h, c) {
  hull() {
    // 上下各缩小c
    translate([0,0,c])
      cylinder(r=r, h=h-2*c, $fn=6);
    // 上端缩小
    translate([0,0,0])
      cylinder(r=r-c, h=h, $fn=6);
  }
}

// 内框
module core_frame() {
  difference() {
    chamfered_hex(hex_r-wall-0.5, body_h-wall*2, chamfer-1);
    // 掏空
    offset_chamfered_hex(hex_r-wall*2-0.5, body_h-wall*4, chamfer-2);
    // PCB圆形卡槽（顶部）
    translate([0, 0, body_h-wall*2-8])
      cylinder(d=pcb_d+0.5, h=2, $fn=80);
    // 电池仓（底部）
    translate([0, 0, wall])
      cube([32, 26, 6], center=true);
  }
  // 磁铁槽（上下各3个，120°均布）
  // PCB弹片/夹持
}

// 顶面板（可换色）
module top_plate() {
  difference() {
    chamfered_hex(hex_r, wall+1, 1);
    // 屏幕窗口
    cylinder(d=screen_d+1, h=10, $fn=80);
    // 磁铁嵌入槽（底面）
    for(a=[0,120,240])
      rotate([0,0,a])
        translate([hex_r-10, 0, -0.1])
          cylinder(d=magnet_d+0.2, h=magnet_h+0.1, $fn=30);
  }
}
```

**P2S兼容性：** ✅ 六边形几何体对FDM非常友好，无复杂悬垂。倒角平面角度可控。磁铁槽需要打印暂停嵌入磁铁或事后胶粘。

---

### 方向C：可站可挂可贴 —— "Companion"（伙伴）

**概念：** 随处安放的AI伙伴。桌上站立是默认姿态；背面有挂孔可上墙；底部嵌磁铁可吸冰箱。形态像一个微缩的台式显示器/相框，但更有机。

**外形描述：**
- 整体形状：前薄后厚的"楔形圆饼"——正面是平的圆形（屏幕），背面鼓起（容纳电子器件）
- 尺寸：直径68mm × 最薄处12mm(正面边缘) × 最厚处25mm(背面中心)
- 正面：圆形屏幕窗口，窄边框2mm
- 背面：鼓起的曲面，中心有钥匙孔型挂墙槽
- 底部：平切一小段（弦切），形成自然站立面，宽约35mm
- 底部站立面上：RWC Bus开口
- 质感：正面哑光黑/白，背面可彩色

**零件清单（3件）：**

| # | 零件 | 说明 |
|---|------|------|
| 1 | 前框 (Front Bezel) | 薄圆环+屏幕窗口，扁平 |
| 2 | 后壳 (Back Body) | 主体结构，含PCB座、电池仓、挂墙槽 |
| 3 | 底座盖 (Stand Cap) | 可拆卸，含RWC Bus开口+磁铁槽 |

**附件（可选打印）：**
- 壁挂支架（L型，卡扣到挂墙槽）
- 斜面底座（15°/30°仰角，改变屏幕朝向）

**组装方式：** 
- 前框+后壳：周边6个卡扣
- 底座盖：2颗磁铁吸附（方便拆装接模块）
- 磁吸方案：底座盖内嵌2颗10mm×3mm钕磁铁（既用于冰箱吸附，也用于底座盖固定）

**RWC Bus位置：** 底部（站立面），通过底座盖暴露。站立时朝下，挂墙时朝下。

**磁吸设计：**
- 底座盖内嵌2颗强力钕磁铁
- 吸力足以承载设备重量（估计总重<80g）
- 冰箱/白板/金属表面均可吸附
- 磁铁同时用于底座盖与后壳的连接

**挂墙设计：**
- 背面钥匙孔槽（标准螺丝头挂法）
- 或者直接用磁铁吸在任何金属表面

**打印参数：**
- 层高：0.2mm（功能件优先，速度快）
- 填充：20% gyroid
- 壁厚：1.6mm
- 支撑：后壳内部PCB卡槽需少量支撑；前框和底座盖无需
- 底切角度：后壳背面弧度控制在50°以内
- 打印方向：后壳开口朝上；前框平放；底座盖平放

**OpenSCAD伪代码：**
```openscad
// Companion - 核心参数
body_d = 68;         // 主体直径
front_h = 12;        // 前端厚度（最薄）
back_h = 25;         // 背部厚度（最厚）
screen_d = 39;
wall = 1.6;
flat_cut = 12;       // 底部平切深度（从圆心到弦的距离）
magnet_d = 10;
magnet_h = 3;

// 楔形圆饼主体
module body_shape() {
  intersection() {
    // 圆柱基础
    cylinder(d=body_d, h=back_h, $fn=100);
    // 楔形切割（前薄后厚）
    hull() {
      // 前端薄
      translate([0, 0, 0])
        cylinder(d=body_d, h=front_h, $fn=100);
      // 后端中心厚
      translate([0, 0, 0])
        cylinder(d=body_d*0.5, h=back_h, $fn=100);
    }
  }
}

// 底部平切（形成站立面）
module with_flat_bottom() {
  difference() {
    body_shape();
    translate([0, -body_d/2-flat_cut, -1])
      cube([body_d*2, body_d, back_h+2], center=true);
  }
}

// 后壳
module back_body() {
  difference() {
    with_flat_bottom();
    // 掏空内部
    translate([0, 0, wall])
      scale([0.9, 0.9, 0.9])
        with_flat_bottom();
    // 前面开口（给前框留位）
    translate([0, 0, -1])
      cylinder(d=body_d-wall*2, h=wall+2, $fn=100);
    // 挂墙钥匙孔
    translate([0, 5, back_h-3]) {
      cylinder(d=8, h=5, $fn=30);      // 大头
      translate([0, -5, 0])
        cylinder(d=4, h=5, $fn=20);    // 细槽
    }
    // 底部磁铁槽×2
    for(x=[-12, 12])
      translate([x, -body_d/2+flat_cut+wall, wall])
        cylinder(d=magnet_d+0.3, h=magnet_h+0.2, $fn=30);
    // RWC Bus底部开口
    translate([0, -body_d/2+flat_cut-1, wall+2])
      cube([22, wall+2, 8], center=true);
  }
  // PCB支撑柱
  // 电池仓隔板
}
```

**P2S兼容性：** ✅ 楔形设计在FDM上很友好。后壳开口朝上打印避免大面积悬垂。底部平切面天然是第一层。

---

## 3. 组装指南框架

### 通用步骤（所有方向适用）

**所需工具：无（零工具设计）**

除非另有说明，所有连接均为卡扣或磁吸。如需额外固定可用少量热熔胶。

**步骤：**

| 步骤 | 操作 | 时间 |
|------|------|------|
| 1 | 拆包，检查零件（壳体2-4件 + 电子板 + 电池 + 磁铁若干） | 1min |
| 2 | 将电池MX1.25插头插入PCB电池座 | 30s |
| 3 | 将电池放入底壳/后壳电池仓，理线 | 30s |
| 4 | 将PCB放入壳体PCB卡位（圆形定位槽，3个支撑柱对齐） | 30s |
| 5 | （如有磁铁）将磁铁按极性压入磁铁槽（注意NS方向标记） | 1min |
| 6 | 合上前壳/顶壳，对齐卡扣，轻压到位（听到"咔"） | 15s |
| 7 | USB-C充电，开机测试 | — |

**总计：约4分钟，零工具**

### PCB固定方式
- 3个均匀分布的支撑柱（高度精确匹配）
- PCB放入后由上壳/前框压住（三明治结构）
- 不需要螺丝——上下壳夹持 + 支撑柱定位

### 电池安装
- MX1.25插头即插即用
- 电池仓带限位壁，防止晃动
- 推荐粘一小片双面胶泡棉固定电池（可选）
- 电池线走线槽避免夹线

### RWC Bus连接器
- PCB侧：焊接8pin直排针（朝壳体开口方向）
- 壳体侧：开口精确对齐排针
- 模块侧：8pin排母插入

---

## 4. 打印可行性分析

### 4.1 材料推荐

| 项目 | PLA | PETG | 推荐 |
|------|-----|------|------|
| 打印难度 | ⭐ 最易 | ⭐⭐ 中等 | PLA |
| 表面质量 | ⭐⭐⭐ 优 | ⭐⭐ 良 | PLA |
| 耐热性 | ❌ 60°C变形 | ✅ 80°C | 室内用PLA够 |
| 韧性 | ❌ 脆 | ✅ 韧 | 卡扣件用PETG |
| 精度 | ⭐⭐⭐ | ⭐⭐ | PLA |
| 丝绸/特殊色 | ⭐⭐⭐ 丰富 | ⭐⭐ 较少 | PLA |

**结论：主体用PLA（颜值+精度），卡扣/弹性件可选PETG（韧性）。最偷懒方案：全PLA，卡扣处加厚设计补偿脆性。**

### 4.2 打印时间估算（P2S，0.4mm喷嘴）

| 方向 | 零件 | 层高 | 预估时间 | 材料用量 |
|------|------|------|----------|----------|
| A Pebble | 上壳 | 0.16mm | ~2.5h | ~25g |
| A Pebble | 底盖 | 0.16mm | ~1h | ~10g |
| B Crystal | 内框 | 0.12mm | ~3h | ~20g |
| B Crystal | 顶/底面板×2 | 0.12mm | ~1h | ~8g |
| B Crystal | 侧裙 | 0.12mm | ~1.5h | ~12g |
| C Companion | 后壳 | 0.2mm | ~2h | ~22g |
| C Companion | 前框 | 0.2mm | ~0.5h | ~5g |
| C Companion | 底座盖 | 0.2mm | ~0.5h | ~4g |

**每个方向总打印时间约3-5小时，材料约30-40g。**

### 4.3 支撑需求分析

| 方向 | 零件 | 需要支撑？ | 说明 |
|------|------|-----------|------|
| A | 上壳 | ✅ 需要 | 屏幕窗口内侧悬垂；球面顶部 |
| A | 底盖 | ❌ 不需要 | 平底打印 |
| B | 内框 | ⚠️ 少量 | PCB卡槽处有局部悬垂 |
| B | 面板 | ❌ 不需要 | 平板件 |
| B | 侧裙 | ⚠️ 少量 | USB-C开口处 |
| C | 后壳 | ✅ 需要 | PCB卡槽、钥匙孔内部 |
| C | 前框/底座盖 | ❌ 不需要 | 简单平面件 |

**建议：** P2S使用树状支撑，接触面积小易移除。支撑接触Z距离0.2mm。

### 4.4 常见失败点与解决方案

| 问题 | 原因 | 解决 |
|------|------|------|
| 卡扣断裂 | PLA脆性 + 卡扣太薄 | 卡扣宽度≥3mm，厚度≥1.5mm；或用PETG打印底盖 |
| 上下壳合不上 | 公差不对 | 预留0.3mm间隙；先打印测试片校准 |
| 屏幕窗口拉丝 | 悬垂面太大 | 加支撑；或窗口设计为圆锥形渐变（减少悬垂角度）|
| 磁铁槽尺寸不对 | 打印收缩 | 槽直径比磁铁大0.2-0.3mm；深度多0.1mm |
| 扬声器闷声 | 格栅孔太小/被堵 | 格栅孔宽≥1mm；打印后用针通一下 |
| USB-C插不进 | 开口偏小 | 开口宽度比USB-C公头大1mm（总宽约10mm）|
| PCB装不进 | 圆形定位偏差 | 定位槽直径比PCB大0.5mm；支撑柱顶部做小锥度导入 |
| 翘边/底面不平 | 第一层附着力差 | P2S用纹理PEI板；首层0.2mm；底面加brim 3mm |

---

## 5. 设计推荐

**首选方向：A（Pebble）**

理由：
1. **零件最少**（2件），组装最简单
2. **打印最友好**（椭球体对FDM自然友好）
3. **手感最好**（圆润，想拿起来把玩）
4. **品牌辨识度高**（市面上大量方盒子，鹅卵石造型独特）
5. **RWC Bus在底部**，干净整洁

**但如果要考虑多场景放置，C（Companion）是实用性最强的。**

---

## 6. 下一步

- [ ] 选定方向后，出精确的OpenSCAD完整模型
- [ ] 打印公差测试片（卡扣配合、磁铁槽、PCB卡位）
- [ ] 确认电池选型（容量 vs 体积权衡）
- [ ] 确认RWC Bus连接器具体型号（2.54mm排针 vs JST vs 弹簧针pogo pin）
- [ ] 设计RWC Bus模块侧的外壳标准（统一尺寸、接口位置）
